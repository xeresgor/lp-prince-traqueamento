/**
 * Design Philosophy: Organic Modernism with Bauhaus Contemporary influence
 * Updated content: Server-Side Tracking Solution with Enhanced UX
 * - Fluid shapes contained in rigorous grid
 * - Generous breathing space (24px multiples)
 * - Emerald green (#047857) for trust and growth
 * - Subtle gradients and backdrop blur for depth
 * - Optimized animations and performance
 */

import { Button } from "@/components/ui/button";
import { Card } from "@/components/ui/card";
import { CheckCircle2, TrendingUp, AlertCircle, Shield, ArrowRight, ChevronDown, Check, Loader2, DollarSign, User, Phone, Zap, MessageCircle, XCircle, Lock, ChevronLeft, ChevronRight } from "lucide-react";
import { cn } from "@/lib/utils";
import { useState, useEffect, useRef } from "react";

export default function Home() {
  const [formData, setFormData] = useState({
    revenue: "",
    name: "",
    phone: ""
  });
  const [submitted, setSubmitted] = useState(false);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [scrollProgress, setScrollProgress] = useState(0);
  const [expandedFaq, setExpandedFaq] = useState<number | null>(null);
  const [visibleBlobs, setVisibleBlobs] = useState(true);
  const [activeProblemCard, setActiveProblemCard] = useState(0);
  const [activeCaseCard, setActiveCaseCard] = useState(0);
  const formRef = useRef<HTMLDivElement>(null);

  // Track scroll progress
  useEffect(() => {
    const handleScroll = () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrolled = (scrollTop / docHeight) * 100;
      setScrollProgress(scrolled);
    };

    window.addEventListener("scroll", handleScroll);
    return () => window.removeEventListener("scroll", handleScroll);
  }, []);

  // Reduce motion preference
  useEffect(() => {
    const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    setVisibleBlobs(!prefersReducedMotion);
  }, []);

  const handleFormChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  const handleFormSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!formData.revenue || !formData.name || !formData.phone) {
      alert("Por favor, preencha todos os campos obrigat√≥rios.");
      return;
    }

    setIsSubmitting(true);

    try {
      // Enviar dados para webhook/backend
      const payload = {
        revenue: formData.revenue,
        name: formData.name,
        phone: formData.phone,
        timestamp: new Date().toISOString(),
        source: "landing-page"
      };

      // Tentar enviar para backend (se dispon√≠vel)
      try {
        await fetch("/api/leads", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
      } catch (err) {
        // Fallback silencioso se backend n√£o dispon√≠vel
        console.log("Backend n√£o dispon√≠vel, continuando com WhatsApp");
      }

      // Ap√≥s sucesso/fallback, abrir WhatsApp
      setTimeout(() => {
        const message = encodeURIComponent(
          `Ol√°! Gostaria de solicitar uma an√°lise personalizada.\n\nFaturamento mensal: ${formData.revenue}\nNome: ${formData.name}\nTelefone: ${formData.phone}`
        );
        window.open(`https://wa.me/5535984341260?text=${message}`, "_blank");
        
        setSubmitted(true);
        setIsSubmitting(false);
        
        setTimeout(() => {
          setFormData({ revenue: "", name: "", phone: "" });
          setSubmitted(false);
        }, 2000);
      }, 500);
    } catch (error) {
      console.error("Erro ao enviar formul√°rio:", error);
      setIsSubmitting(false);
    }
  };

  const handleCTAClick = () => {
    const message = encodeURIComponent("Ol√°! Gostaria de descobrir quanto estou perdendo com meu rastreamento atual.");
    window.open(`https://wa.me/5535984341260?text=${message}`, "_blank");
  };

  const faqItems = [
    {
      question: "√â dif√≠cil de instalar?",
      answer: "N√£o! Nossa equipe faz toda a instala√ß√£o em 48 horas. Voc√™ n√£o precisa mexer em c√≥digo. Basta fornecer acesso ao seu painel de an√∫ncios."
    },
    {
      question: "Funciona com Shopify/WooCommerce/Bagy?",
      answer: "Sim! Somos compat√≠veis com todas as plataformas de e-commerce: Shopify, WooCommerce, Bagy, Tray, Vtex e mais. Se voc√™ vende online, n√≥s cobrimos."
    },
    {
      question: "Quanto custa?",
      answer: "Oferecemos planos flex√≠veis baseados no seu faturamento. Primeiros 10 clientes recebem 30 dias de suporte gr√°tis + instala√ß√£o sem custo adicional."
    },
    {
      question: "Preciso de conhecimento t√©cnico?",
      answer: "N√£o. Voc√™ n√£o precisa saber programar. N√≥s cuidamos de toda a parte t√©cnica. Voc√™ s√≥ precisa responder algumas perguntas sobre sua conta de an√∫ncios."
    },
    {
      question: "E se eu cancelar?",
      answer: "Sem multa de cancelamento. Voc√™ pode cancelar a qualquer momento. Mas com 14 dias de garantia, voc√™ ver√° os resultados antes de se comprometer."
    },
    {
      question: "Quanto tempo demora para ver resultado?",
      answer: "Voc√™ come√ßa a ver dados mais precisos em 48-72 horas. Em 30 dias, voc√™ ter√° clareza total de quanto estava perdendo e quanto est√° recuperando."
    }
  ];

  return (
    <div className="min-h-screen relative overflow-hidden">
      {/* Progress Bar */}
      <div className="fixed top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary to-secondary z-50" style={{ width: `${scrollProgress}%` }}></div>

      {/* Animated blob backgrounds - with reduced opacity and will-change optimization */}
      {visibleBlobs && (
        <div className="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
          <div className="absolute top-0 -left-40 w-96 h-96 bg-accent rounded-full mix-blend-multiply filter blur-3xl opacity-40 animate-blob" style={{ willChange: "transform" }}></div>
          <div className="absolute top-0 -right-40 w-96 h-96 bg-accent rounded-full mix-blend-multiply filter blur-3xl opacity-40 animate-blob animation-delay-2000" style={{ willChange: "transform" }}></div>
          <div className="absolute -bottom-40 left-1/2 w-96 h-96 bg-accent rounded-full mix-blend-multiply filter blur-3xl opacity-40 animate-blob animation-delay-4000" style={{ willChange: "transform" }}></div>
        </div>
      )}

      {/* HEADER COM NAVEGA√á√ÉO */}
      <header className="sticky top-1 z-40 bg-background/80 backdrop-blur-md border-b border-border">
        <div className="container py-4 flex items-center justify-between">
          <img 
            src="https://files.manuscdn.com/user_upload_by_module/session_file/310519663334312014/zRzOaCoTsSkIAQNJ.png" 
            alt="Prince Ads" 
            className="h-12 md:h-14 lg:h-16 w-auto"
            loading="lazy"
          />
          <nav className="flex items-center gap-8">
            <a href="#como-funciona" className="text-sm font-semibold text-foreground hover:text-primary transition-colors">
              Como Funciona
            </a>
            <a href="#beneficios" className="text-sm font-semibold text-foreground hover:text-primary transition-colors">
              Benef√≠cios
            </a>
            <a href="#faq" className="text-sm font-semibold text-foreground hover:text-primary transition-colors">
              FAQ
            </a>
            <a 
              href="https://wa.me/5535984341260" 
              target="_blank" 
              rel="noopener noreferrer" 
              className="text-sm font-semibold text-primary hover:text-primary/80 transition-colors"
            >
              Contato
            </a>
          </nav>
        </div>
      </header>

      {/* SE√á√ÉO 1: HERO */}
      <section className="container py-16 lg:py-24">
        <div className="grid lg:grid-cols-12 gap-12 lg:gap-16 items-center">
          {/* Left Content */}
          <div className="lg:col-span-7 space-y-8">
            <div className="space-y-6">
              <h1 className="text-4xl sm:text-5xl lg:text-6xl leading-tight font-bold">
                Desbloqueie 30% de Vendas Invis√≠veis que o Facebook N√£o Mostra <span className="text-primary">(E Seus Concorrentes Est√£o Lucrando)</span>
              </h1>
              
              <p className="text-lg text-muted-foreground leading-relaxed max-w-2xl">
                Voc√™ est√° pausando campanhas lucrativas e escalando campanhas que d√£o preju√≠zo. Hoje isso acaba.
              </p>

              <p className="text-base text-foreground leading-relaxed max-w-2xl font-medium">
                Enquanto o Gerenciador de An√∫ncios do Facebook diz "10 vendas", seu banco mostra 15. Essa diferen√ßa de 35% √© lucro que voc√™ est√° jogando fora TODOS OS DIAS.
              </p>
            </div>

            {/* CTA Buttons */}
            <div className="flex flex-col sm:flex-row gap-4 pt-4">
              <Button 
                size="lg" 
                className="bg-primary hover:bg-primary/90 text-primary-foreground px-8 py-6 text-base font-semibold rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1"
                onClick={handleCTAClick}
              >
                Descobrir Quanto Estou Perdendo
                <ArrowRight className="w-5 h-5 ml-2" />
              </Button>
              <Button 
                size="lg" 
                variant="outline"
                className="px-8 py-6 text-base font-semibold rounded-2xl"
                onClick={() => {
                  document.getElementById("como-funciona")?.scrollIntoView({ behavior: "smooth" });
                }}
              >
                Ver Como Funciona (2 min)
              </Button>
            </div>
          </div>

          {/* Right Visual - Comparison Chart */}
          <div className="lg:col-span-5">
            <div className="relative bg-card rounded-2xl p-8 shadow-xl border border-border">
              <h3 className="text-sm font-semibold text-muted-foreground mb-6 uppercase tracking-wide">Compara√ß√£o de Rastreamento</h3>
              
              <div className="space-y-6">
                {/* Pixel Browser */}
                <div className="space-y-2">
                  <div className="flex items-center justify-between mb-2">
                    <span className="font-semibold text-foreground">Pixel (Navegador)</span>
                    <span className="text-sm font-bold text-red-600">65%</span>
                  </div>
                  <div className="w-full bg-muted rounded-full h-3 overflow-hidden">
                    <div 
                      className="bg-red-600 h-full rounded-full transition-all duration-1000 ease-out" 
                      style={{ width: '65%' }}
                    ></div>
                  </div>
                </div>

                {/* API Server-Side */}
                <div className="space-y-2">
                  <div className="flex items-center justify-between mb-2">
                    <span className="font-semibold text-foreground">API (Server-Side)</span>
                    <span className="text-sm font-bold text-primary">100%</span>
                  </div>
                  <div className="w-full bg-muted rounded-full h-3 overflow-hidden">
                    <div 
                      className="bg-primary h-full rounded-full transition-all duration-1000 ease-out" 
                      style={{ width: '100%' }}
                    ></div>
                  </div>
                </div>
              </div>

              <div className="mt-8 p-4 bg-primary/10 rounded-lg border border-primary/20">
                <p className="text-sm text-foreground">
                  <span className="font-semibold">Diferen√ßa: 35%</span> de dados perdidos com rastreamento tradicional
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Separador visual */}
      <div className="h-px bg-gradient-to-r from-transparent via-border to-transparent"></div>

      {/* SE√á√ÉO 2: O PROBLEMA */}
      <section className="container py-16 lg:py-24" id="beneficios">
        <div className="max-w-4xl mx-auto">
          <div className="text-center mb-12">
            <h2 className="text-4xl lg:text-5xl font-bold mb-4">
              Por Que Voc√™ Est√° Perdendo 3 a 4 Vendas de Cada 10 (E N√£o Sabe)
            </h2>
            <p className="text-lg text-muted-foreground max-w-2xl mx-auto">
              N√£o adianta ter o melhor criativo se a ferramenta de tr√°fego est√° cega. Hoje, confiar apenas no Pixel instalado no site √© garantia de perder dados.
            </p>
          </div>

          {/* 3 Cards - Hierarquia visual */}
          <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
            {[
              {
                icon: AlertCircle,
                title: "35% das Suas Vendas S√£o Invis√≠veis",
                description: "iOS 14.5 bloqueou seus dados. Voc√™ est√° otimizando no escuro.",
                impact: true
              },
              {
                icon: Shield,
                title: "40% dos Visitantes Usam Bloqueador",
                description: "S√£o vendas que ACONTECEM mas n√£o aparecem no relat√≥rio.",
                impact: true
              },
              {
                icon: TrendingUp,
                title: "Voc√™ Pausa Campanhas Lucrativas",
                description: "E escala campanhas que d√£o preju√≠zo. Zero intelig√™ncia, s√≥ desperd√≠cio.",
                impact: true
              }
            ].map((item, index) => {
              const Icon = item.icon;
              return (
                <Card 
                  key={index} 
                  className={`p-6 bg-card hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:scale-105 ${
                    index < 3 ? "md:col-span-1" : "md:col-span-1"
                  }`}
                >
                  <Icon className="w-8 h-8 text-primary mb-4" />
                  <h3 className="text-xl font-semibold mb-3 text-foreground">{item.title}</h3>
                  <p className="text-muted-foreground leading-relaxed">{item.description}</p>
                </Card>
              );
            })}
          </div>
        </div>
      </section>

      {/* Separador visual */}
      <div className="h-px bg-gradient-to-r from-transparent via-border to-transparent"></div>

      {/* SE√á√ÉO 3: A SOLU√á√ÉO */}
      <section className="container py-16 lg:py-24">
        <div className="max-w-4xl mx-auto">
          <div className="bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl p-8 lg:p-12 border border-primary/20">
            <div className="inline-block bg-primary text-primary-foreground px-4 py-2 rounded-full text-sm font-semibold mb-6">
              PROTOCOLO CAPI SERVER-SIDE
            </div>

            <h2 className="text-4xl lg:text-5xl font-bold mb-6">
              A Solu√ß√£o Definitiva: Tracking Server-Side
            </h2>

            <p className="text-lg text-muted-foreground leading-relaxed mb-8">
              N√≥s implementamos uma infraestrutura que n√£o depende da vontade do navegador do usu√°rio. Criamos uma 'estrada direta' entre seu site e as plataformas de an√∫ncio.
            </p>

            {/* Checklist com micro-provas */}
            <div className="space-y-4">
              {[
                { title: "Recupera√ß√£o de Dados", desc: "Pegue as convers√µes que o Pixel perdeu. 100% de precis√£o - conferimos centavo por centavo com seu gateway." },
                { title: "Atribui√ß√£o Correta", desc: "Saiba exatamente qual campanha trouxe a venda. Decis√µes 47% mais r√°pidas com dados precisos." },
                { title: "P√∫blicos Melhores", desc: "Otimize o Remarketing com quem realmente visitou. Aumente convers√£o de retargeting em at√© 3x." }
              ].map((item, index) => (
                <div key={index} className="flex items-start gap-3">
                  <CheckCircle2 className="w-6 h-6 text-primary flex-shrink-0 mt-0.5" />
                  <div>
                    <span className="text-base font-semibold text-foreground">{item.title}</span>
                    <p className="text-sm text-muted-foreground mt-1">{item.desc}</p>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      </section>

      {/* Separador visual */}
      <div className="h-px bg-gradient-to-r from-transparent via-border to-transparent"></div>

      {/* SE√á√ÉO 4: COMO FUNCIONA */}
      <section className="container py-16 lg:py-24" id="como-funciona">
        <div className="max-w-4xl mx-auto">
          <h2 className="text-4xl lg:text-5xl font-bold text-center mb-12">
            A Diferen√ßa na Pr√°tica
          </h2>

          <div className="grid lg:grid-cols-2 gap-8">
            {/* Left - Apenas Pixel */}
            <Card className="p-8 bg-red-50 border-red-200 hover:shadow-lg transition-all duration-300">
              <div className="flex items-center gap-3 mb-6">
                <div className="w-4 h-4 rounded-full bg-red-500"></div>
                <h3 className="text-2xl font-bold text-red-900">Apenas Pixel</h3>
                <span className="text-xs font-semibold text-red-600 ml-auto">Jeito Amador</span>
              </div>

              <p className="text-red-800 leading-relaxed mb-6">
                Voc√™ fica ref√©m dos cookies. Se o usu√°rio limpa o hist√≥rico ou usa iPhone, voc√™ perde o rastro. O resultado √© um CPA falso e medo de aumentar o or√ßamento.
              </p>

              <div className="bg-red-100 rounded-lg p-4 border border-red-200">
                <p className="text-sm font-semibold text-red-900">
                  Confiabilidade dos Dados: <span className="text-red-600">Baixa e Inst√°vel</span>
                </p>
              </div>
            </Card>

            {/* Right - Server-Side */}
            <Card className="p-8 bg-primary/10 border-primary/20 hover:shadow-lg transition-all duration-300">
              <div className="flex items-center gap-3 mb-6">
                <div className="w-4 h-4 rounded-full bg-primary"></div>
                <h3 className="text-2xl font-bold text-primary">Server-Side</h3>
                <span className="text-xs font-semibold text-primary ml-auto">Jeito Profissional</span>
              </div>

              <p className="text-foreground leading-relaxed mb-6">
                Voc√™ tem controle total. Os eventos s√£o enviados do servidor, imunes a bloqueadores. Voc√™ tem seguran√ßa para escalar campanhas vencedoras.
              </p>

              <div className="bg-primary/20 rounded-lg p-4 border border-primary/30">
                <p className="text-sm font-semibold text-foreground">
                  Confiabilidade dos Dados: <span className="text-primary">M√°xima e Precisa</span>
                </p>
              </div>
            </Card>
          </div>
        </div>
      </section>

      {/* Separador visual */}
      <div className="h-px bg-gradient-to-r from-transparent via-border to-transparent"></div>

      {/* SE√á√ÉO 5: DEPOIMENTOS */}
      <section className="container py-16 lg:py-24">
        <div className="text-center mb-12">
          <h2 className="text-4xl lg:text-5xl font-bold mb-4">
            Quem tem dados, tem escala.
          </h2>
          <p className="text-lg text-muted-foreground max-w-2xl mx-auto">
            Veja o impacto de ter os n√∫meros corretos.
          </p>
        </div>

        <div className="grid md:grid-cols-3 gap-8 max-w-4xl mx-auto">
          {[
            {
              title: "E-commerce de Moda",
              result: "de R$ 80k/m√™s para R$ 120k/m√™s em 60 dias",
              metric: "+50% em vendas"
            },
            {
              title: "Infoprodutor",
              result: "Recuperou 38% de dados perdidos com bloqueios",
              metric: "+R$45k/m√™s"
            },
            {
              title: "Dropshipping",
              result: "Bate centavo por centavo com o gateway",
              metric: "100% de precis√£o"
            }
          ].map((testimonial, index) => (
            <Card key={index} className="p-6 bg-card hover:shadow-lg transition-all duration-300">
              <div className="mb-4">
                <p className="text-foreground font-semibold text-lg mb-2">{testimonial.title}</p>
                <p className="text-muted-foreground text-sm leading-relaxed">
                  {testimonial.result}
                </p>
              </div>
              <div className="border-t border-border pt-4">
                <p className="font-bold text-primary text-sm">{testimonial.metric}</p>
              </div>
            </Card>
          ))}
        </div>
      </section>

      {/* Separador visual */}
      <div className="h-px bg-gradient-to-r from-transparent via-border to-transparent"></div>

      {/* SE√á√ÉO 6: FAQ */}
      <section className="container py-16 lg:py-24" id="faq">
        <div className="max-w-3xl mx-auto">
          <h2 className="text-4xl lg:text-5xl font-bold text-center mb-12">
            Perguntas Frequentes
          </h2>

          <div className="space-y-4">
            {faqItems.map((item, index) => (
              <div key={index} className="border border-border rounded-lg overflow-hidden hover:border-primary/50 transition-colors">
                <button
                  onClick={() => setExpandedFaq(expandedFaq === index ? null : index)}
                  className="w-full px-6 py-4 flex items-center justify-between bg-card hover:bg-muted transition-colors"
                >
                  <span className="font-semibold text-foreground text-left">{item.question}</span>
                  <ChevronDown 
                    className={`w-5 h-5 text-primary transition-transform ${expandedFaq === index ? "rotate-180" : ""}`}
                  />
                </button>
                {expandedFaq === index && (
                  <div className="px-6 py-4 bg-muted border-t border-border">
                    <p className="text-muted-foreground leading-relaxed">{item.answer}</p>
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      </section>

      {/* Separador visual */}
      <div className="h-px bg-gradient-to-r from-transparent via-border to-transparent"></div>

      {/* SE√á√ÉO 7: CTA FINAL COM FORMUL√ÅRIO */}
      <section className="container py-16 lg:py-24" ref={formRef}>
        <div className="max-w-3xl mx-auto">
          {/* Badge de B√¥nus com Glow Animado */}
          <div className="relative inline-block mb-8 w-full flex justify-center">
            <div className="absolute -inset-1 bg-gradient-to-r from-amber-400 via-orange-500 to-amber-400 rounded-full blur-sm opacity-75 animate-pulse"></div>
            <div className="relative bg-gradient-to-r from-amber-50 to-amber-100 text-amber-900 px-6 py-3 rounded-full text-sm font-black uppercase tracking-wider border-2 border-amber-300 shadow-xl flex items-center gap-2">
              <span className="text-lg">üî•</span>
              <span>B√îNUS: Primeiros 10 Clientes</span>
              <span className="hidden sm:inline">‚Ä¢</span>
              <span className="hidden sm:inline">Instala√ß√£o + 30 Dias GR√ÅTIS</span>
            </div>
          </div>

          {/* T√≠tulo e Subt√≠tulo */}
          <h2 className="text-3xl md:text-4xl lg:text-5xl font-bold mb-4 tracking-tight leading-tight text-center">
            Quanto Voc√™ Est√° Perdendo Agora?
          </h2>
          <p className="text-xl md:text-2xl text-primary font-semibold mb-12 text-center">
            (Em m√©dia, nossos clientes recuperam R$ 18.500/m√™s)
          </p>

          {/* Card do Formul√°rio com Gradiente e Decora√ß√£o */}
          <Card className="p-10 lg:p-14 bg-gradient-to-br from-white via-white to-primary/5 backdrop-blur-sm border-2 border-primary/20 shadow-2xl rounded-[2.5rem] relative overflow-hidden">
            {/* Detalhes decorativos */}
            <div className="absolute top-0 right-0 w-32 h-32 bg-primary/5 rounded-full blur-3xl -mr-16 -mt-16"></div>
            <div className="absolute bottom-0 left-0 w-32 h-32 bg-primary/5 rounded-full blur-3xl -ml-16 -mb-16"></div>

            {/* Conte√∫do do formul√°rio */}
            <div className="relative z-10">
              <form onSubmit={handleFormSubmit} className="space-y-6">
                {/* Campo 1: Faturamento Mensal */}
                <div className="space-y-3">
                  <label className="block text-sm font-bold text-foreground ml-1">
                    Quanto sua empresa fatura mensalmente?
                  </label>
                  <div className="relative group">
                    <DollarSign className="absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground pointer-events-none z-10 group-hover:text-primary transition-colors" />
                    <select
                      name="revenue"
                      value={formData.revenue}
                      onChange={handleFormChange}
                      required
                      className="w-full pl-14 pr-12 py-4 rounded-2xl border-2 border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all appearance-none cursor-pointer hover:border-primary/50"
                    >
                      <option value="">Selecione uma op√ß√£o</option>
                      <option value="10-50K">R$ 10-50K/m√™s</option>
                      <option value="50-120K">R$ 50-120K/m√™s</option>
                      <option value="120-240K">R$ 120-240K/m√™s</option>
                      <option value="240K+">R$ 240K+/m√™s</option>
                    </select>
                    <ChevronDown className="absolute right-5 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground pointer-events-none group-hover:text-primary transition-colors" />
                    {formData.revenue && (
                      <div className="absolute right-12 top-1/2 -translate-y-1/2 w-6 h-6 bg-emerald-100 rounded-full flex items-center justify-center">
                        <Check className="w-4 h-4 text-emerald-600" />
                      </div>
                    )}
                  </div>
                </div>

                {/* Grid 2 colunas: Nome e Telefone */}
                <div className="grid md:grid-cols-2 gap-6">
                  {/* Campo 2: Nome Completo */}
                  <div className="space-y-3">
                    <label className="block text-sm font-bold text-foreground ml-1">
                      Seu Nome Completo
                    </label>
                    <div className="relative group">
                      <User className="absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground pointer-events-none z-10 group-hover:text-primary transition-colors" />
                      <input
                        type="text"
                        name="name"
                        value={formData.name}
                        onChange={handleFormChange}
                        required
                        placeholder="Jo√£o Silva"
                        className="w-full pl-14 pr-12 py-4 rounded-2xl border-2 border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all hover:border-primary/50 placeholder:text-muted-foreground/50"
                      />
                      {formData.name && formData.name.length >= 3 && (
                        <div className="absolute right-4 top-1/2 -translate-y-1/2 w-6 h-6 bg-emerald-100 rounded-full flex items-center justify-center">
                          <Check className="w-4 h-4 text-emerald-600" />
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Campo 3: WhatsApp */}
                  <div className="space-y-3">
                    <label className="block text-sm font-bold text-foreground ml-1">
                      WhatsApp para Contato
                    </label>
                    <div className="relative group">
                      <Phone className="absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground pointer-events-none z-10 group-hover:text-primary transition-colors" />
                      <input
                        type="tel"
                        name="phone"
                        value={formData.phone}
                        onChange={handleFormChange}
                        required
                        placeholder="(35) 98765-4321"
                        className="w-full pl-14 pr-12 py-4 rounded-2xl border-2 border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all hover:border-primary/50 placeholder:text-muted-foreground/50"
                      />
                      {formData.phone && formData.phone.length >= 10 && (
                        <div className="absolute right-4 top-1/2 -translate-y-1/2 w-6 h-6 bg-emerald-100 rounded-full flex items-center justify-center">
                          <Check className="w-4 h-4 text-emerald-600" />
                        </div>
                      )}
                    </div>
                  </div>
                </div>

                {/* Bot√£o CTA com Shine Effect */}
                <Button
                  type="submit"
                  disabled={isSubmitting || submitted}
                  size="lg"
                  className="bg-primary hover:bg-primary/90 text-primary-foreground px-12 py-7 text-lg md:text-xl font-bold rounded-[1.5rem] shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1 hover:scale-[1.02] w-full relative overflow-hidden group disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  {/* Shine effect ao hover */}
                  <div className="absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>

                  <span className="relative z-10 flex items-center justify-center gap-3">
                    {isSubmitting ? (
                      <>
                        <Loader2 className="w-6 h-6 animate-spin" />
                        <span>Preparando sua an√°lise...</span>
                      </>
                    ) : submitted ? (
                      <>
                        <Check className="w-6 h-6" />
                        <span>Recebemos seus dados!</span>
                      </>
                    ) : (
                      <>
                        <span>Descobrir Minha Perda Agora</span>
                        <ArrowRight className="w-6 h-6 group-hover:translate-x-1 transition-transform" />
                      </>
                    )}
                  </span>
                </Button>
              </form>

              {/* Grid de Benef√≠cios com √çcones */}
              <div className="space-y-4 pt-8">
                <div className="grid grid-cols-2 gap-3">
                  {[
                    { icon: Zap, text: "Instala√ß√£o em 48h", color: "text-blue-600", bg: "bg-blue-50" },
                    { icon: MessageCircle, text: "Suporte em portugu√™s", color: "text-emerald-600", bg: "bg-emerald-50" },
                    { icon: Shield, text: "14 dias de garantia", color: "text-amber-600", bg: "bg-amber-50" },
                    { icon: XCircle, text: "Sem multa", color: "text-purple-600", bg: "bg-purple-50" }
                  ].map((item, i) => (
                    <div key={i} className="flex items-center gap-2.5 text-foreground">
                      <div className={`w-8 h-8 rounded-xl flex items-center justify-center flex-shrink-0 ${item.bg}`}>
                        <item.icon className={`w-4 h-4 ${item.color}`} />
                      </div>
                      <span className="text-xs font-semibold leading-tight">{item.text}</span>
                    </div>
                  ))}
                </div>

                {/* Texto de Privacidade */}
                <div className="flex items-start gap-2 p-3 bg-muted/30 rounded-xl border border-border/30">
                  <Lock className="w-4 h-4 text-muted-foreground mt-0.5 flex-shrink-0" />
                  <p className="text-[11px] text-muted-foreground leading-relaxed">
                    Seus dados s√£o 100% seguros. N√£o enviamos spam. Apenas an√°lise personalizada via WhatsApp.
                  </p>
                </div>
              </div>

              {/* Loading State */}
              {isSubmitting && (
                <div className="absolute inset-0 bg-white/95 backdrop-blur-md rounded-[2rem] flex items-center justify-center z-20">
                  <div className="flex flex-col items-center gap-4">
                    <div className="relative">
                      <div className="w-20 h-20 border-4 border-primary/20 rounded-full"></div>
                      <div className="w-20 h-20 border-4 border-t-primary rounded-full animate-spin absolute inset-0"></div>
                      <Loader2 className="w-8 h-8 text-primary absolute inset-0 m-auto" />
                    </div>
                    <div className="text-center">
                      <p className="text-lg font-bold text-foreground mb-1">
                        Preparando sua an√°lise...
                      </p>
                      <p className="text-sm text-muted-foreground">
                        Isso leva apenas alguns segundos
                      </p>
                    </div>
                  </div>
                </div>
              )}

              {/* Success State */}
              {submitted && (
                <div className="absolute inset-0 bg-gradient-to-br from-emerald-50 to-emerald-100/50 backdrop-blur-md rounded-[2rem] flex items-center justify-center z-20">
                  <div className="flex flex-col items-center gap-4 px-6 text-center">
                    <div className="relative">
                      <div className="w-20 h-20 bg-emerald-500 rounded-full flex items-center justify-center animate-bounce">
                        <Check className="w-10 h-10 text-white" />
                      </div>
                    </div>
                    <div>
                      <p className="text-2xl font-black text-emerald-700 mb-2">
                        An√°lise Recebida!
                      </p>
                      <p className="text-sm text-emerald-600 font-medium mb-1">
                        Redirecionando para o WhatsApp...
                      </p>
                      <p className="text-xs text-muted-foreground">
                        Voc√™ receber√° uma an√°lise personalizada em instantes
                      </p>
                    </div>
                  </div>
                </div>
              )}
            </div>
          </Card>
        </div>
      </section>

      {/* WhatsApp Float Button - Responsivo e com z-index maior */}
      <a
        href="https://wa.me/5535984341260?text=Ol√°! Gostaria de saber mais sobre o trackeamento server-side."
        target="_blank"
        rel="noopener noreferrer"
        className="fixed bottom-6 right-6 lg:bottom-8 lg:right-8 bg-[#25D366] hover:bg-[#20BA5A] text-white p-4 rounded-full shadow-2xl transition-all duration-300 hover:scale-110 z-50"
        aria-label="Fale pelo WhatsApp"
        onClick={() => {
          // Track event aqui (Meta Pixel, GA4, etc)
          if (typeof window !== 'undefined' && (window as any).fbq) {
            (window as any).fbq('track', 'Contact');
          }
        }}
      >
        <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.272-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.67-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.076 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421-7.403h-.004a9.87 9.87 0 00-4.255.949c-1.238.503-2.335 1.236-3.356 2.258-1.688 1.694-2.76 3.957-2.76 6.514 0 1.869.384 3.647 1.235 5.282L2.89 23.585l3.02-.798c1.946.67 3.957.995 5.922.995 5.386 0 9.783-4.401 9.783-9.787 0-2.615-.997-5.071-2.809-6.881-1.812-1.812-4.266-2.809-6.881-2.809z"/>
        </svg>
      </a>
    </div>
  );
}
